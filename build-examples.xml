<?xml version="1.0" encoding="UTF-8"?>
<project name="aislib-examples" default="deploy-examples">

	<import file="build.xml" />

	<target name="init">
		<mkdir dir="${examplesdir}" />
	</target>

	<target name="deploy-examples" depends="init,dumper,filter,sender" />

	<target name="dumper">
		<mkdir dir="${examplesdir}/dumper" />
		<mkdir dir="${examplesdir}/dumper/lib" />
		<jar file="${examplesdir}/dumper/lib/dumper.jar">
			<fileset dir="${build.classes-examples.dir}">
				<include name="**/dumper/**" />
			</fileset>
			<manifest>
				<attribute name="Built-By" value="${user.name}" />
				<attribute name="Main-Class" value="dk.frv.ais.examples.dumper.AisDumper" />
			</manifest>
		</jar>
		<copy todir="${examplesdir}/dumper" overwrite="true">
			<fileset dir="${src.examples.resources.dir}/dumper" />
		</copy>
		<copy todir="${examplesdir}/dumper/lib" overwrite="true">
			<fileset dir="${extlib}">
				<include name="**/*.jar" />
			</fileset>
		</copy>
		<copy file="${build.dir}/${build.final.name}" todir="${examplesdir}/dumper/lib" overwrite="true" />
	</target>

	<target name="run-dumper" depends="examples">
		<java classname="dk.frv.ais.examples.dumper.AisDumper" fork="true" dir="${examplesdir}/dumper">
			<classpath>
				<pathelement path="${examplesdir}/dumper" />
				<fileset dir="${examplesdir}/dumper/lib">
					<include name="**/*.jar" />
				</fileset>
			</classpath>
		</java>
	</target>

	<target name="filter">
		<mkdir dir="${examplesdir}/filter" />
		<mkdir dir="${examplesdir}/filter/lib" />
		<jar file="${examplesdir}/filter/lib/filter.jar">
			<fileset dir="${build.classes-examples.dir}">
				<include name="**/filter/**" />
			</fileset>
			<manifest>
				<attribute name="Built-By" value="${user.name}" />
				<attribute name="Main-Class" value="dk.frv.ais.examples.filter.AisFilter" />
			</manifest>
		</jar>
		<copy todir="${examplesdir}/filter" overwrite="true">
			<fileset dir="${src.examples.resources.dir}/filter" />
		</copy>
		<copy todir="${examplesdir}/filter/lib" overwrite="true">
			<fileset dir="${extlib}">
				<include name="**/*.jar" />
			</fileset>
		</copy>
		<copy file="${build.dir}/${build.final.name}" todir="${examplesdir}/filter/lib" overwrite="true" />
	</target>

	<target name="sender">
		<mkdir dir="${examplesdir}/sender" />
		<mkdir dir="${examplesdir}/sender/lib" />
		<jar file="${examplesdir}/sender/lib/sender.jar">
			<fileset dir="${build.classes-examples.dir}">
				<include name="**/sender/**" />
			</fileset>
			<manifest>
				<attribute name="Built-By" value="${user.name}" />
				<attribute name="Main-Class" value="dk.frv.ais.examples.sender.SrmSend" />
			</manifest>
		</jar>
		<copy todir="${examplesdir}/sender" overwrite="true">
			<fileset dir="${src.examples.resources.dir}/sender" />
		</copy>
		<copy todir="${examplesdir}/sender/lib" overwrite="true">
			<fileset dir="${extlib}">
				<include name="**/*.jar" />
			</fileset>
		</copy>
		<copy file="${build.dir}/${build.final.name}" todir="${examplesdir}/sender/lib" overwrite="true" />
	</target>

</project>
